This is much more complicated than I would like.